{
  "records": [
    {
      "data": {
        "account": 12345,
        "region": "...",
        "detail-type": "...",
        "source": "...",
        "version": "...",
        "time": "...",
        "id": "12345",
        "resources": {
          "test": "..."
        },
        "detail": {
          "eventVersion": "...",
          "userIdentity": {
            "type": "...",
            "principalId": "...",
            "arn": "...",
            "accountId": "12345",
            "userName": "...",
            "sessionContext": {
              "attributes": {
                "mfaAuthenticated": "true",
                "creationDate": "..."
              }
            },
            "invokedBy": "..."
          },
          "eventTime": "...",
          "eventSource": "...",
          "eventName": "PutBucketAcl",
          "awsRegion": "...",
          "sourceIPAddress": "...",
          "userAgent": "...",
          "requestParameters": {
            "bucketName": "...",
            "AccessControlPolicy": {
              "AccessControlList": {
                "Grant": [
                  {
                    "Grantee": {
                      "xsi:type": "CanonicalUser",
                      "DisplayName": "...",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "ID": "..."
                    },
                    "Permission": "FULL_CONTROL"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/global/AllUsers"
                    },
                    "Permission": "READ"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/global/AllUsers"
                    },
                    "Permission": "READ_ACP"
                  }
                ]
              },
              "xmlns": "http://s3.amazonaws.com/doc/2006-03-01/",
              "Owner": {
                "DisplayName": "...",
                "ID": "..."
              }
            },
            "acl": [
              ""
            ]
          },
          "responseElements": null,
          "requestID": "...",
          "eventID": "...",
          "eventType": "AwsApiCall",
          "recipientAccountId": "12345"
        }
      },
      "description": "An AWS S3 bucket with 'AllUsers' permission(s) will create an alert.",
      "log": "cloudwatch:events",
      "source": "prefix_cluster1_stream_alert_kinesis",
      "service": "kinesis",
      "trigger_rules": ["cloudtrail_put_bucket_acl"]
    },
    {
      "data": {
        "account": 12345,
        "region": "...",
        "detail-type": "...",
        "source": "...",
        "version": "...",
        "time": "...",
        "id": "12345",
        "resources": {
          "test": "..."
        },
        "detail": {
          "eventVersion": "...",
          "userIdentity": {
            "type": "...",
            "principalId": "...",
            "arn": "...",
            "accountId": "12345",
            "userName": "...",
            "sessionContext": {
              "attributes": {
                "mfaAuthenticated": "true",
                "creationDate": "..."
              }
            },
            "invokedBy": "..."
          },
          "eventTime": "...",
          "eventSource": "...",
          "eventName": "PutBucketAcl",
          "awsRegion": "...",
          "sourceIPAddress": "...",
          "userAgent": "...",
          "requestParameters": {
            "bucketName": "...",
            "AccessControlPolicy": {
              "AccessControlList": {
                "Grant": [
                  {
                    "Grantee": {
                      "xsi:type": "CanonicalUser",
                      "DisplayName": "...",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "ID": "..."
                    },
                    "Permission": "FULL_CONTROL"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
                    },
                    "Permission": "READ"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
                    },
                    "Permission": "READ_ACP"
                  }
                ]
              },
              "xmlns": "http://s3.amazonaws.com/doc/2006-03-01/",
              "Owner": {
                "DisplayName": "...",
                "ID": "..."
              }
            },
            "acl": [
              ""
            ]
          },
          "responseElements": null,
          "requestID": "...",
          "eventID": "...",
          "eventType": "AwsApiCall",
          "recipientAccountId": "12345"
        }
      },
      "description": "An AWS S3 bucket with 'AuthenticatedUsers' permission(s) will create an alert.",
      "log": "cloudwatch:events",
      "source": "prefix_cluster1_stream_alert_kinesis",
      "service": "kinesis",
      "trigger_rules": ["cloudtrail_put_bucket_acl"]
    },
    {
      "data": {
        "account": 12345,
        "region": "...",
        "detail-type": "...",
        "source": "...",
        "version": "...",
        "time": "...",
        "id": "12345",
        "resources": {
          "test": "..."
        },
        "detail": {
          "eventVersion": "...",
          "userIdentity": {
            "type": "...",
            "principalId": "...",
            "arn": "...",
            "accountId": "12345",
            "userName": "...",
            "sessionContext": {
              "attributes": {
                "mfaAuthenticated": "true",
                "creationDate": "..."
              }
            },
            "invokedBy": "..."
          },
          "eventTime": "...",
          "eventSource": "...",
          "eventName": "PutBucketAcl",
          "awsRegion": "...",
          "sourceIPAddress": "...",
          "userAgent": "...",
          "requestParameters": {
            "bucketName": "...",
            "AccessControlPolicy": {
              "AccessControlList": {
                "Grant": [
                  {
                    "Grantee": {
                      "xsi:type": "CanonicalUser",
                      "DisplayName": "...",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "ID": "..."
                    },
                    "Permission": "FULL_CONTROL"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/s3/LogDelivery"
                    },
                    "Permission": "READ"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/s3/LogDelivery"
                    },
                    "Permission": "READ_ACP"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/s3/LogDelivery"
                    },
                    "Permission": "READ"
                  },
                  {
                    "Grantee": {
                      "xsi:type": "Group",
                      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                      "URI": "http://acs.amazonaws.com/groups/s3/LogDelivery"
                    },
                    "Permission": "READ_ACP"
                  }
                ]
              },
              "xmlns": "http://s3.amazonaws.com/doc/2006-03-01/",
              "Owner": {
                "DisplayName": "...",
                "ID": "..."
              }
            },
            "acl": [
              ""
            ]
          },
          "responseElements": null,
          "requestID": "...",
          "eventID": "...",
          "eventType": "AwsApiCall",
          "recipientAccountId": "12345"
        }
      },
      "description": "An AWS PutBucketAcl call without 'AuthenticatedUsers' & 'AllUsers' will not create an alert.",
      "log": "cloudwatch:events",
      "source": "prefix_cluster1_stream_alert_kinesis",
      "service": "kinesis",
      "trigger_rules": []
    }
  ]
}
