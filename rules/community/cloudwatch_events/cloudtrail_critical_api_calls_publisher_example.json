[
  {
    "data": {
      "Records": [
        {
          "eventVersion": "1.05",
          "userIdentity": {
            "accessKeyId": "...",
            "accountId": "12345",
            "arn": "...",
            "invokedBy": "...",
            "principalId": "12345",
            "sessionContext": {
              "attributes": {
                "creationDate": "...",
                "mfaAuthenticated": "true"
              }
            },
            "type": "..."
          },
          "eventTime": "2019-07-09T16:59:01Z",
          "eventSource": "ec2.amazonaws.com",
          "eventName": "DisableEbsEncryptionByDefault",
          "awsRegion": "us-west-1",
          "sourceIPAddress": "...",
          "userAgent": "...",
          "requestParameters": {
            "DisableEbsEncryptionByDefaultRequest": {}
          },
          "responseElements": {
            "DisableEbsEncryptionByDefaultResponse": {
              "xmlns": "http://ec2.amazonaws.com/doc/2016-11-15/",
              "ebsEncryptionByDefault": false,
              "requestId": "19a19cd8-5f1b-4d5e-8af4-3e826fa03d0f"
            }
          },
          "requestID": "...",
          "eventID": "...",
          "eventType": "AwsApiCall",
          "recipientAccountId": "123456789123"
        }
      ]
    },
    "description": "Disabling default EBS encryption",
    "log": "cloudtrail:events",
    "service": "s3",
    "source": "prefix.cluster.sample.bucket",
    "trigger_rules": [
      "cloudtrail_critical_api_calls_publisher_example",
      "cloudtrail_critical_api_calls"
    ],
    "publisher_tests": {
      "slack:sample-channel": [
        {
          "jmespath_expression": "keys(@)",
          "condition": "is",
          "value": [
            "@slack.text",
            "@slack.attachments",
            "@slack._previous_publication"
          ]
        },
        [
          "\"@slack.text\"",
          "is",
          "Rule triggered"
        ],
        [
          "\"@slack.attachments\"[0].title",
          "is",
          "cloudtrail_critical_api_calls_publisher_example"
        ],
        [
          "\"@slack.attachments\"[0].title_link",
          "is",
          "https://github.com/airbnb/streamalert/search?q=cloudtrail_critical_api_calls_publisher_example+path%3A%2Frules"
        ],
        [
          "\"@slack.attachments\"[1].fields[0].title",
          "is",
          "Note"
        ],
        [
          "\"@slack.attachments\"[1].fields[0].value",
          "is",
          "This is purely for example purposes in testing, and is not meant to be used as-is"
        ],
        [
          "\"@slack.attachments\"[2].title",
          "is",
          "Record"
        ],
        [
          "\"@slack.attachments\"[2].text",
          "contains",
          "\"requestId\": \"19a19cd8-5f1b-4d5e-8af4-3e826fa03d0f\""
        ],
        [
          "\"@slack.attachments\"[2].author",
          "is",
          "prefix.cluster.sample.bucket"
        ],
        [
          "\"@slack.attachments\"[2].fields[0].title",
          "is",
          "Alert Id"
        ]
      ],
      "pagerduty:sample-integration": [
        [
          "\"@pagerduty.description\"",
          "is",
          "cloudtrail_critical_api_calls_publisher_example"
        ],
        [
          "\"@pagerduty.details\".eventName",
          "contains",
          "DisableEbsEncryptionByDefault"
        ],
        [
          "\"@pagerduty.details\".eventSource",
          "contains",
          "ec2.amazonaws.com"
        ]
      ]
    }
  }
]